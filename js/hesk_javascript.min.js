function hesk_insertTag(e){hesk_insertAtCursor(document.form1.msg,"%%"+e+"%%"),document.form1.msg.focus()}function hesk_insertAtCursor(e,t){if(document.selection)e.focus(),(sel=document.selection.createRange()).text=t;else if(e.selectionStart||"0"==e.selectionStart){var n=e.selectionStart,s=e.selectionEnd;e.value=e.value.substring(0,n)+t+e.value.substring(s,e.value.length),e.selectionStart=n+t.length,e.selectionEnd=n+t.length}else e.value+=t}function hesk_changeAll(e,t=0){for(var n=document.form1,s=!!e.checked,o=0;o<n.elements.length;o++)"checkbox"==n.elements[o].type&&"checkall"!=n.elements[o].name&&(0==t?n.elements[o].checked=s:n.elements[o].classList.contains(t)&&(n.elements[o].checked=s))}function hesk_attach_disable(e){for($i=0;$i<e.length;$i++)("c11"==e[$i]||"c21"==e[$i]||"c31"==e[$i]||"c41"==e[$i]||"c51"==e[$i])&&(document.getElementById(e[$i]).checked=!1),document.getElementById(e[$i]).disabled=!0}function hesk_attach_enable(e){for($i=0;$i<e.length;$i++)document.getElementById(e[$i]).disabled=!1}function hesk_attach_handle(e,t){for($i=0;$i<t.length;$i++)document.getElementById(t[$i]).disabled=!e.checked}function hesk_attach_toggle(e,t){document.getElementById(e).checked?hesk_attach_enable(t):hesk_attach_disable(t)}function hesk_window(e,t,n){window.open(e,"Hesk_window","height="+t+",width="+n+",menubar=0,location=0,toolbar=0,status=0,resizable=1,scrollbars=1").focus()}function hesk_toggleLayerDisplay(e,t="block"){document.all?document.all[e].style.display="none"==document.all[e].style.display?t:"none":document.getElementById&&(document.getElementById(e).style.display="none"==document.getElementById(e).style.display?t:"none")}function hesk_confirmExecute(e){return!!confirm(e)}function hesk_deleteIfSelected(e,t){if(document.getElementById(e).checked)return hesk_confirmExecute(t)}function hesk_rate(e,t){if(0==e.length)return!1;var n=document.getElementById(t);if(null==(xmlHttp=GetXmlHttpObject())){alert("Your browser does not support AJAX!");return}xmlHttp.open("GET",e,!0),xmlHttp.onreadystatechange=function(){4==xmlHttp.readyState&&200==xmlHttp.status&&(n.innerHTML=xmlHttp.responseText)},xmlHttp.send(null)}function stateChanged(){4==xmlHttp.readyState&&(document.getElementById("rating").innerHTML=xmlHttp.responseText)}function GetXmlHttpObject(){var e=null;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){e=new ActiveXObject("Microsoft.XMLHTTP")}}return e}var heskKBquery="",heskKBfailed=!1;function hesk_suggestKB(){var e=document.form1,t=e.subject.value,n=e.message.value,s=document.getElementById("kb_suggestions");if(""!=t&&""!=n&&(heskKBquery!=t+" "+n||!0==heskKBfailed)){s.style.display="block";var o="p=1&q="+encodeURIComponent(t+" "+n);if(heskKBquery=t+" "+n,null==(xmlHttp=GetXmlHttpObject()))return;xmlHttp.open("POST","suggest_articles.php",!0),xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlHttp.onreadystatechange=function(){4==xmlHttp.readyState&&200==xmlHttp.status?(s.innerHTML=xmlHttp.responseText,heskKBfailed=!1):heskKBfailed=!0},xmlHttp.send(o)}setTimeout(function(){hesk_suggestKB()},2e3)}function hesk_suggestKBsearch(e){var t=document.searchform.search.value,n=document.getElementById("kb_suggestions");if(e)var s="admin_suggest_articles.php";else var s="suggest_articles.php";if(""!=t&&(heskKBquery!=t||!0==heskKBfailed)){n.style.display="block";var o="q="+encodeURIComponent(t);if(heskKBquery=t,null==(xmlHttp=GetXmlHttpObject()))return;xmlHttp.open("POST",s,!0),xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlHttp.onreadystatechange=function(){4==xmlHttp.readyState&&200==xmlHttp.status?(n.innerHTML=unescape(xmlHttp.responseText),heskKBfailed=!1):heskKBfailed=!0},xmlHttp.send(o)}setTimeout(function(){hesk_suggestKBsearch(e)},2e3)}function hesk_suggestEmail(e,t,n,s,o){var a=document.getElementById(e).value,r=document.getElementById(t);if(s)var l="../suggest_email.php";else var l="suggest_email.php";if(""!=a){var c="e="+encodeURIComponent(a)+"&ef="+encodeURIComponent(e)+"&dd="+encodeURIComponent(t)+"&pd="+encodeURIComponent(n);if(o&&(c+="&am=1"),null==(xmlHttp=GetXmlHttpObject()))return;xmlHttp.open("POST",l,!0),xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlHttp.onreadystatechange=function(){if(4===xmlHttp.readyState&&200===xmlHttp.status){r.innerHTML="";for(var t='<div class="notification-flash service-message orange" id="{0}" style="display: block; margin-bottom: 10px;"><div class="notification--title">{1}</div><div class="notification--text"><a class="link" href="javascript:" onclick="hesk_applyEmailSuggestion(\'{0}\', \''+e+"', '{2}', '{3}')\">{4}</a> | <a class=\"link\" href=\"javascript:void(0);\" onclick=\"document.getElementById('{0}').style.display='none';\">{5}</a></div></div>",n=JSON.parse(xmlHttp.responseText),s=0;s<n.length;s++){var o=n[s];r.innerHTML+=t.replace(/\{0}/g,o.id).replace(/\{1}/g,o.suggestText).replace(/\{2}/g,o.originalAddress).replace(/\{3}/g,o.formattedSuggestedEmail).replace(/\{4}/g,o.yesResponseText).replace(/\{5}/g,o.noResponseText),console.log(n[s])}r.style.display="block"}},xmlHttp.send(c)}}function hesk_applyEmailSuggestion(e,t,n,s){var o=document.getElementById(t).value,a=RegExp(n,"gi");document.getElementById(t).value=o.replace(a,s),document.getElementById(e).style.display="none"}function hesk_btn(e,t){e.className=t}function hesk_checkPassword(e,t="progressBar"){var n="!.@$#*()%~<>{}[]",s=0,o=0;hesk_contains(e,"0123456789")>0&&(s+=10,o+=25),hesk_contains(e,"abcdefghijklmnopqrstuvwxyz")>0&&(s+=26,o+=25),hesk_contains(e,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")>0&&(s+=26,o+=25),hesk_contains(e,n)>0&&(s+=n.length,o+=25);var a,r=Math.pow(s,e.length)/200/2/86400/365e3,l=hesk_cap(Math.round(100*r),o);l<5*e.length&&(l+=5*e.length);var l=hesk_cap(l,o),c=document.getElementById(t);if(c.style.width=l+"%",r>1&&l>75){c.style.backgroundColor="#3bce08";return}if(r>.5&&l>50){c.style.backgroundColor="#ffd801";return}if(r>.1&&l>10){c.style.backgroundColor="orange";return}if(r<=.1||l<=10){c.style.backgroundColor="red";return}}function hesk_cap(e,t){return e>t?t:e}function hesk_contains(e,t){for(i=0,count=0;i<e.length;i++){var n=e.charAt(i);t.indexOf(n)>-1&&count++}return count}function setCookie(e,t,n,s,o,a){document.cookie=e+"="+escape(t)+(n?"; expires="+n.toGMTString():"")+(s?"; path="+s:"")+(o?"; domain="+o:"")+(a?"; secure":"")}function getCookie(e){var t=document.cookie,n=e+"=",s=t.indexOf("; "+n);if(-1==s){if(0!=(s=t.indexOf(n)))return null}else s+=2;var o=document.cookie.indexOf(";",s);return -1==o&&(o=t.length),unescape(t.substring(s+n.length,o))}function deleteCookie(e,t,n){getCookie(e)&&(document.cookie=e+"="+(t?"; path="+t:"")+(n?"; domain="+n:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT")}function outputAttachmentIdHolder(e,t){$("#attachment-holder-"+t).append('<input type="hidden" name="attachments[]" value="'+e+'">')}function removeAttachment(e,t,n){void 0!==t&&($('input[name="attachments[]"][value="'+t+'"]').remove(),$.ajax({url:(n?"../":"")+"upload_attachment.php?action=delete&fileKey="+encodeURIComponent(t),method:"GET"}))}function hesk_updateDeleteCategoryUrl(e){var t=$("#targetCat"+e).val(),n=$("a[data-confirm-button]")[e];n.href=n.href.replace(/&targetCategory=\d+/i,"&targetCategory="+t)}function hesk_loadNoResultsSelectizePlugin(e){Selectize.define("no_results",function(t){var n,s,o,a,r=this;t=$.extend({message:e,html:function(e){return'<div class="selectize-dropdown '+e.classNames+'"><div class="selectize-dropdown-content"><div class="no-results">'+e.message+"</div></div></div>"}},t),r.displayEmptyResultsMessage=function(){this.$empty_results_container.css("top",this.$control.outerHeight()),this.$empty_results_container.css("width",this.$control.outerWidth()),this.$empty_results_container.show(),this.$control.addClass("dropdown-active")},r.refreshOptions=(n=r.refreshOptions,function(){n.apply(r,arguments),this.hasOptions||!this.lastQuery?this.$empty_results_container.hide():this.displayEmptyResultsMessage()}),r.onKeyDown=(s=r.onKeyDown,function(e){s.apply(r,arguments),27===e.keyCode&&this.$empty_results_container.hide()}),r.onBlur=(o=r.onBlur,function(){o.apply(r,arguments),this.$empty_results_container.hide(),this.$control.removeClass("dropdown-active")}),r.setup=(a=r.setup,function(){a.apply(r,arguments),r.$empty_results_container=$(t.html($.extend({classNames:r.$input.attr("class")},t))),r.$empty_results_container.insertBefore(r.$dropdown),r.$empty_results_container.hide()})})}function hesk_selectizeAddCustomAddEntryToDropdown(e){return{newEntryTextPrefix:e.newEntryTextPrefix,create:function(e){return{}},showAddOptionOnCreate:!0,onInitialize:function(){var e=this;e.on("type",function(t){var n=$(e.$dropdown),s=e.settings.create;if(s){var o=n.find(".add-entry-option");if(0===o.length);else{o.html(e.settings.newEntryTextPrefix+": "+t);var a=n.find(".option:not(.add-entry-option):visible").length;o.toggleClass("with-results-above",a>0)}}if(1===e.currentResults.items.length)e.setActiveOption(n.find("[data-selectable"));else if(s&&0===e.currentResults.items.length){var o=n.find(".add-entry-option");o.length>0&&e.setActiveOption(o)}}),e.$control_input.on("keydown",function(t){var n=t.keyCode||t.which,s=$(e.$dropdown);if(e.settings.create&&13===n&&0===e.currentResults.items.length&&e.isOpen){t.preventDefault();var o=s.find(".add-entry-option");return o.length>0&&o.click(),!1}})},onDropdownOpen:function(t){var n=this;t.find(".add-entry-option").remove();var s=t.find(".option:not(.add-entry-option):visible").length,o=$('<div class="option add-entry-option">'+n.settings.newEntryTextPrefix+"</div>");o.toggleClass("with-results-above",s>0),o.on("click",function(){let t=n.$control_input.val();e.onAddEntryClickedFunction(n,t),n.close()}),t.append(o)},render:{option_create:function(e,t){return""}}}}function hesk_debounce(e,t,n){var s;return function(){var o=this,a=arguments,r=n&&!s;clearTimeout(s),s=setTimeout(function(){s=null,n||e.apply(o,a)},t),r&&e.apply(o,a)}}function hesk_showLoadingMessage(e){document.getElementById("loading-overlay").style.display="block",document.getElementById(e).disabled=!0}function hesk_toggleShowPassword(e){var t=document.getElementById(e);"password"===t.type?t.type="text":t.type="password"}jQuery.fn.preventDoubleSubmission=function(){return $(this).on("submit",function(e){var t=$(this);!0===t.data("submitted")?e.preventDefault():t.data("submitted",!0)}),this};